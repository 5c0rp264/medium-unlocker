var background=function(){"use strict";
/*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   */var e=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},n=t||{},a=e.split(i),c=n.decode||o,u=0;u<a.length;u++){var d=a[u],p=d.indexOf("=");if(!(p<0)){var l=d.substr(0,p).trim(),m=d.substr(++p,d.length).trim();'"'==m[0]&&(m=m.slice(1,-1)),null==r[l]&&(r[l]=s(m,c))}}return r},t=function(e,t,o){var i=o||{},s=i.encode||r;if("function"!=typeof s)throw new TypeError("option encode is invalid");if(!n.test(e))throw new TypeError("argument name is invalid");var a=s(t);if(a&&!n.test(a))throw new TypeError("argument val is invalid");var c=e+"="+a;if(null!=i.maxAge){var u=i.maxAge-0;if(isNaN(u)||!isFinite(u))throw new TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(u)}if(i.domain){if(!n.test(i.domain))throw new TypeError("option domain is invalid");c+="; Domain="+i.domain}if(i.path){if(!n.test(i.path))throw new TypeError("option path is invalid");c+="; Path="+i.path}if(i.expires){if("function"!=typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+i.expires.toUTCString()}i.httpOnly&&(c+="; HttpOnly");i.secure&&(c+="; Secure");if(i.sameSite){switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;case"none":c+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return c},o=decodeURIComponent,r=encodeURIComponent,i=/; */,n=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function s(e,t){try{return t(e)}catch(t){return e}}var a={parse:e,serialize:t},c={operationName:{cookieStatus:"PostMeter",postContent:"PostViewerEdgeContentQuery"},operationSelector:{cookieStatus:"data.meterPost.unlocksRemaining"},memberShipId:"paywall-fewerClicksHeading",registerWall:"regwall-heading",domainList:["https://medium.com/*","https://*.medium.com/*","https://towardsdatascience.com/*","https://hackernoon.com/*","https://medium.freecodecamp.org/*","https://psiloveyou.xyz/*","https://betterhumans.coach.me/*","https://codeburst.io/*","https://theascent.pub/*","https://medium.mybridge.co/*","https://uxdesign.cc/*","https://levelup.gitconnected.com/*","https://itnext.io/*","https://entrepreneurshandbook.co/*","https://proandroiddev.com/*","https://blog.prototypr.io/*","https://thebolditalic.com/*","https://blog.usejournal.com/*","https://blog.angularindepth.com/*","https://blog.bitsrc.io/*","https://blog.devartis.com/*","https://blog.maddevs.io/*","https://blog.getambassador.io/*","https://uxplanet.org/*","https://instagram-engineering.com/*","https://calia.me/*","https://productcoalition.com/*","https://engineering.opsgenie.com/*","https://android.jlelse.eu/*","https://robinhood.engineering/*","https://blog.hipolabs.com/*","https://ux.shopify.com/*"]};const{domainList:u}=c,d="/_/graphql";let p=!1,l={unlocksRemaining:0},m=[];function h(){try{if(p)return;p=!0,chrome.storage.local.get(["unlocker"],(function(e){!e.unlocker||e.unlocker.unlocksRemaining<1?(p=!0,fetch("https://medium-unlocker.azurewebsites.net/api/medium-unlocker").then((e=>e.json())).then((e=>{const t=a.parse(e["set-cookie"].join("; "));l.uid=t.uid,l.sid=t.sid,l.optimizelyEndUserId=t.optimizelyEndUserId,l.unlocksRemaining=3})).finally((()=>{chrome.storage.local.set({unlocker:l}),p=!1}))):(p=!1,l=e.unlocker)}))}catch(e){console.error(e)}}chrome.runtime.onMessage.addListener((function({request:e},t,o){"fetch-cookie"===e&&h(),"get-cookie"===e&&o({response:e,data:l})})),chrome.webRequest.onBeforeSendHeaders.addListener((function({url:e,requestId:t,requestHeaders:o}){if(!1===e.endsWith(d))return{requestHeaders:o};const r=o.filter((({name:e})=>"graphql-operation"===e.toLowerCase()));if(!r.length||r.length&&"PostViewerEdgeContentQuery"!==r[0].value)return{requestHeaders:o};m.push(t);let i=o.filter((({name:e})=>"cookie"!==e.toLowerCase()));const n=o.filter((({name:e})=>"cookie"===e.toLowerCase()));if(1===n.length){let e=decodeURIComponent(n[0].value);return e=e.replace(/uid=(\w+);/,`uid=${l.uid||""};`),e=e.replace(/sid=(.{0,100});/,`sid=${encodeURIComponent(l.sid||"")};`),e=e.replace(/optimizelyEndUserId=(\w+);/,`optimizelyEndUserId=${l.optimizelyEndUserId||""};`),i.push({name:"cookie",value:e}),l.unlocksRemaining-=1,chrome.storage.local.set({unlocker:l}),{requestHeaders:i}}return{requestHeaders:o}}),{urls:u},function(){const e=["blocking","requestHeaders"];return chrome.webRequest.OnBeforeSendHeadersOptions.hasOwnProperty("EXTRA_HEADERS")&&e.push("extraHeaders"),e}()),chrome.webRequest.onHeadersReceived.addListener((function({url:e,requestId:t,requestHeaders:o}){return!1===e.endsWith(d)||!1===m.includes(t)?{requestHeaders:o}:{responseHeaders:o.filter((({name:e})=>"set-cookie"!==e.toLowerCase()))}}),{urls:u},["blocking","responseHeaders"]);return{}}();
