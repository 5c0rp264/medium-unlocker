var background=function(){"use strict";var e={operationName:{cookieStatus:"PostMeter",postContent:"PostViewerEdgeContentQuery"},operationSelector:{cookieStatus:"data.meterPost.unlocksRemaining"},memberShipId:"paywall-fewerClicksHeading",registerWall:"regwall-heading",domainList:["https://medium.com/*","https://*.medium.com/*","https://towardsdatascience.com/*","https://hackernoon.com/*","https://medium.freecodecamp.org/*","https://psiloveyou.xyz/*","https://betterhumans.coach.me/*","https://codeburst.io/*","https://theascent.pub/*","https://medium.mybridge.co/*","https://uxdesign.cc/*","https://levelup.gitconnected.com/*","https://itnext.io/*","https://entrepreneurshandbook.co/*","https://proandroiddev.com/*","https://blog.prototypr.io/*","https://thebolditalic.com/*","https://blog.usejournal.com/*","https://blog.angularindepth.com/*","https://blog.bitsrc.io/*","https://blog.devartis.com/*","https://blog.maddevs.io/*","https://blog.getambassador.io/*","https://uxplanet.org/*","https://instagram-engineering.com/*","https://calia.me/*","https://productcoalition.com/*","https://engineering.opsgenie.com/*","https://android.jlelse.eu/*","https://robinhood.engineering/*","https://blog.hipolabs.com/*","https://ux.shopify.com/*","https://enlear.academy/*","https://www.cantorsparadise.com/*","https://betterprogramming.pub/*","https://blog.roost.io/*","https://500ish.com/*","https://faun.pub/*","https://towardsdev.com/*","https://javascript.plainenglish.io/*"]};function t(e,t){let o="",r=t.length;for(let s=0;s<e;s++)o+=t.charAt(Math.floor(Math.random()*r));return o}var o={generateUID:()=>`lo_${t(12,"0123456789abcdef")}`,generateSID:()=>`1:${t(64,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._/")}`,getBeforeSendExtraInfoSpec:()=>{const e=["blocking","requestHeaders"];return chrome.webRequest.OnBeforeSendHeadersOptions.hasOwnProperty("EXTRA_HEADERS")&&e.push("extraHeaders"),e},getHeaderReceivedExtraInfoSpec:()=>{const e=["blocking","responseHeaders"];return chrome.webRequest.OnHeadersReceivedOptions.hasOwnProperty("EXTRA_HEADERS")&&e.push("extraHeaders"),e},getHeaders:(e,t,o)=>e.filter((({name:e})=>o(e.toLowerCase(),t))),hasElm:e=>!!document.getElementById(e),getRealObjectKey:(e,t)=>Object.keys(e).find((e=>e.toLowerCase()===t))},r={initChrome:()=>{var e=XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(t,o){var r=this.onreadystatechange,s=this;return s.onreadystatechange=function(){if(console.info("_this.readyState",s.readyState),4===s.readyState&&200===s.status&&~o.indexOf("/_/graphql")){try{var e=JSON.parse(s.responseText);e.fields&&e.fields.push("c","d"),Object.defineProperty(s,"responseText",{value:JSON.stringify(e)})}catch(e){console.log("e",e)}console.log("Caught! :)",t,o)}r&&r.apply(this,arguments)},Object.defineProperty(this,"onreadystatechange",{get:function(){return r},set:function(e){r=e}}),e.apply(s,arguments)}}};const{domainList:s}=e,{generateUID:n,generateSID:a,getBeforeSendExtraInfoSpec:i,getHeaderReceivedExtraInfoSpec:d,getHeaders:c}=o,{initChrome:p}=r,l="/_/graphql",h=["PostViewerEdgeContentQuery","PostHandler"];let u=[],g="";chrome.webRequest.onBeforeSendHeaders.addListener((function({url:e,requestId:t,requestHeaders:o}){if(!1===e.endsWith(l))return{requestHeaders:o};const r=o.filter((({name:e})=>"graphql-operation"===e.toLowerCase()));if(!r.length||r.length&&!h.includes(r[0].value))return{requestHeaders:o};u.push(t);let s=c(o,"cookie",((e,t)=>e!==t));const i=c(o,"cookie",((e,t)=>e===t));if(1===i.length){const e=n(),t=a();let o=decodeURIComponent(i[0].value);const r=/uid=(\w+);/.exec(o);return r&&r.length>1&&(g=r[1]),o=o.replace(/uid=(\w+);/,`uid=${e};`),o=o.replace(/sid=(.{0,72});/,`sid=${encodeURIComponent(t)};`),o=o.replace(/optimizelyEndUserId=(\w+);/,`optimizelyEndUserId=${e};`),s.push({name:"cookie",value:o}),{requestHeaders:s}}return{requestHeaders:o}}),{urls:s},i()),chrome.webRequest.onHeadersReceived.addListener((function({requestId:e,responseHeaders:t}){return!1===u.includes(e)?{responseHeaders:t}:{responseHeaders:c(t,"set-cookie",((e,t)=>e!==t))}}),{urls:s},d()),"undefined"!=typeof browser?chrome.webRequest.onBeforeRequest.addListener((function({requestId:e,url:t}){if(!1===t.endsWith(l))return{};let o=browser.webRequest.filterResponseData(e),r=new TextDecoder("utf-8"),s=new TextEncoder,n=[];o.ondata=e=>{n.push(e.data)},o.onstop=t=>{let a="";if(1==n.length)a=r.decode(n[0]);else for(let e=0;e<n.length;e++){let t=e!=n.length-1;a+=r.decode(n[e],{stream:t})}if(g&&u.includes(e)){const e=/postId:(\w+)\-viewerId:(lo_\w+)/gm.exec(a);if(e&&3===e.length){let t=new RegExp(`${e[2]}`,"g");a=a.replace(t,g)}}o.write(s.encode(a)),o.close()}}),{urls:s},["blocking"]):p();return{}}();
